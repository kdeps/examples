amends "package://schema.kdeps.com/core@0.2.42#/Resource.pkl"

ActionID = "llmActivities"
Name = "AI Helper for Output"
Description = "An AI helper to generate a polished output using LLM."
Category = ""
Requires {
    "llmWeatherReport"
}
Run {
        SkipCondition {
                // Conditions under which the execution of this resource should be skipped.
                // If any evaluated condition returns true, the resource execution will be bypassed.
        }
        PreflightCheck {
                Validations {
                        // This section expects boolean validations.
                        // If any validation returns false, an exception will be thrown before proceeding to the next step.
                }
                // Custom error message and code to be used if the preflight check fails.
                Error {
                        Code = 0
                        Message = ""
                }
        }

        // Initializes a chat session with the LLM for this resource.
        //
        // This resource offers the following helper functions:
        //
        // - "@(llm.response("ResourceID"))"
        // - "@(llm.prompt("ResourceID"))"
        //
        // To use these in your resource, you can define a local variable as follows:
        //
        // local llmResponse = "@(llm.response("ResourceID"))"
        // You can then access the value with "@(llmResponse)".
        //
        // The "@(...)" syntax enables lazy evaluation, ensuring that values are
        // retrieved only after the result is ready.
        //
        // Note: Each resource is restricted to a single dedicated action. Combining multiple
        // actions within the same resource is not allowed.
        Chat {
                Model = "llama3.1" // This LLM model needs to be defined in the workflow
                Prompt = """
                Without prefacing it with anything, giving explanations or justifications, present a concise,
                plain-language summary of activity recommendations based on the data provided. Write in three or more
                paragraphs, focusing on Event Schedules: Suggest local concerts, festivals, or cultural events that are
                better suited to the current weather conditions. Outdoor Conditions: Recommend hiking trails, parks, or
                gardens that are optimal in the given weather. Indoor Venues: Include museums, theaters, shopping malls,
                and other indoor attractions during inclement weather. Ensure the language is simple and easy to
                understand. Use plain text, with no line breaks. The data is as follows:

                @(llm.response("llmWeatherReport"))
                """

                // Specify if the LLM response should be a structured JSON
                JSONResponse = false

                // If JSONResponse is true, then the structured JSON data will need to have the
                // following keys.
                JSONResponseKeys {}

                // Specify the files that this LLM will process.
                Files {
                        // "@(request.files()[0])"
                }

                // Timeout duration in seconds. This specifies when to terminate the llm session.
                TimeoutDuration = 600.s
        }
}
